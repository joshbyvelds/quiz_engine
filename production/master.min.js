(function($){var questions=QUESTIONS;var available_questions;var question_max=5;var current_question_counter;var second_chance;var questions_correct;var current_mode;function reset(){questions_correct=0;available_questions=questions.slice(0);current_question_counter=0}function showFinalResults(){$("#result_correct").text(Number.parseFloat(questions_correct/10).toFixed(1));$("#result_total").text(question_max);$("#result_percent").text(questions_correct/10/question_max*100+"%");$("#result_play_again").off().on("click",function(){$("#results").hide();loadQuiz(current_mode)});$("#result_menu").off().on("click",function(){$("#results").hide();$("#menu").show()});$("#quiz").hide();$("#results").show()}function getRandomQuestion(){var random_num=Math.floor(Math.random()*available_questions.length);var question=available_questions.slice(random_num,random_num+1);available_questions.splice(random_num,1);return question[0]}function setupMainMenu(){$(".game_start_btn").off().on("click",function(){$("#menu").hide();loadQuiz($(this).attr("data-mode"))});$("#stats_btn").off().on("click",function(){showStats()})}function loadQuestion(){second_chance=false;if(current_question_counter===question_max){showFinalResults()}$("#feedback").hide();current_question=getRandomQuestion();$("#question_text").html(current_question.Question);for(var i=current_question.Answers.length;i>=0;i--){$("#answer"+(i+1)).attr("data-answer-id",i).html(current_question.Answers[i])}$(".answer").removeAttr("disabled","disabled").css("opacity",1).shuffle().off().on("click",function(){checkAnswer($(this))});current_question_counter++;$("#question_number").html(current_question_counter)}function checkAnswer(btn){var answer_id=parseInt($(btn).attr("data-answer-id"));var correct=current_question.Correct;$(".answer").off();$.post("/post",{key:"question",question:current_question.ID,answer:answer_id,correct:answer_id===correct},function(){if(answer_id===correct){if(second_chance){questions_correct+=5}else{questions_correct+=10}$("#feedback_text").html("Correct, Nice work");$("#feedback").addClass("correct");setTimeout(function(){loadQuestion()},1e3)}else{$(btn).attr("disabled","disabled").css("opacity",.3);$("#feedback_text").html("Incorrect, Please try again");$("#feedback").addClass("incorrect");if(!second_chance){second_chance=true;$(".answer").off().on("click",function(){checkAnswer($(this))});$(btn).off()}else{setTimeout(function(){loadQuestion()},1e3)}}$("#feedback").show()})}function loadModeOne(){reset();$("#menu").hide();$("#quiz").show();$("#question_total").text(question_max);loadQuestion()}function loadModeTwo(){}function loadModeThree(){}function loadQuiz(mode){current_mode=parseInt(mode);switch(current_mode){case 1:loadModeOne();break;case 2:loadModeTwo();break;case 3:loadModeThree();break}}function showStats(){alert("Show Stats")}function init(){setupMainMenu()}$(document).ready(init);$.fn.shuffle=function(){var allElems=this.get(),getRandom=function(max){return Math.floor(Math.random()*max)},shuffled=$.map(allElems,function(){var random=getRandom(allElems.length),randEl=$(allElems[random]).clone(true)[0];allElems.splice(random,1);return randEl});this.each(function(i){$(this).replaceWith($(shuffled[i]))});return $(shuffled)}})(jQuery);